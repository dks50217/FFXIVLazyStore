@using System.Globalization
@inject HttpClient httpClient
@inject NavigationManager navigationManager

<RadzenStack AlignItems="AlignItems.Center" class="rz-p-12">
    <RadzenPanelMenu Style="width:300px">
        <RadzenPanelMenuItem Text="Home" Icon="Home"></RadzenPanelMenuItem>
        <RadzenPanelMenuItem Text="LazyShop" Icon="shopping_bag">
            @if (categoryVM != null)
            {
                @foreach (var item in categoryVM.categories)
                {
                    <RadzenPanelMenuItem Text="@item.name" Path="@($"LazyShop/{item.id}")">
                        @foreach (var subItem in item.subCategories)
                        {
                            <RadzenPanelMenuItem Style="margin-left:10px;" Text="@subItem.name" Path="@($"LazyShop/{item.id}/{subItem.id}")"></RadzenPanelMenuItem>
                        }
                    </RadzenPanelMenuItem>
                }
            }
        </RadzenPanelMenuItem>
    </RadzenPanelMenu>
</RadzenStack>

@code {
    private CategoryVM? categoryVM { get; set; }

    protected override async Task OnInitializedAsync()
    {
        var requestUri = $"https://api.store.finalfantasyxiv.com/ffxivcatalog/api/categories?lang={CultureInfo.CurrentCulture.Name}";
        var result = await httpClient.GetFromJsonAsync<CategoryVM>(requestUri);

        if (result != null)
        {
            this.categoryVM = result;
        }
    }
}